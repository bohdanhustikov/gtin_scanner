<body>
    <h2>EAN-13 Barcode Scanner (GS1 –£–∫—Ä–∞—ó–Ω–∞)</h2>
    <div id="reader"></div>
    <button id="scan-btn">–°–∫–∞–Ω—É–≤–∞—Ç–∏ —à—Ç—Ä–∏—Ö-–∫–æ–¥</button>
    
    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è:</h3>
    <div id="result">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è...</div>

    <!-- –∑–∞–≤—á–∞—Å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∫–Ω–æ–ø–∫–∏ (–ø–æ—á–∞—Ç–∫–æ–≤–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ) -->
    <button id="copy-btn" style="display:none;">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –∫–æ–¥</button>
    <button id="search-btn" style="display:none;">üîé –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ GS1 UA</button>

    <script>
        const html5QrCode = new Html5Qrcode("reader");
        const qrConfig = { fps: 10, qrbox: { width: 250, height: 150 } };

        let lastDecodedText = "";

        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                alert(`EAN-13 –∫–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä: ${text}`);
            } catch (err) {
                alert('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É: ' + err);
            }
        }

        function searchGS1UA(ean13) {
            window.open(`https://newgepir.gs1ua.org/search/gtin/${ean13}`, '_blank');
        }

        document.getElementById("scan-btn").addEventListener("click", () => {
            document.getElementById("copy-btn").style.display = "none";
            document.getElementById("search-btn").style.display = "none";
            document.getElementById("result").innerText = "–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è...";

            html5QrCode.start({ facingMode: "environment" }, qrConfig, (decodedText) => {
                lastDecodedText = decodedText;
                html5QrCode.stop();
                document.getElementById("result").innerHTML = `–†–æ–∑–ø—ñ–∑–Ω–∞–Ω–∏–π –∫–æ–¥: <strong>${decodedText}</strong>`;
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏ –ø—ñ—Å–ª—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è
                document.getElementById("copy-btn").style.display = "inline-block";
                document.getElementById("search-btn").style.display = "inline-block";
            }).catch(err => {
                document.getElementById("result").innerText = `–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É —Å–∫–∞–Ω–µ—Ä–∞: ${err}`;
            });
        });

        // –Ø–≤–Ω—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
        document.getElementById("copy-btn").addEventListener("click", () => {
            copyToClipboard(lastDecodedText);
        });

        document.getElementById("search-btn").addEventListener("click", () => {
            searchGS1UA(lastDecodedText);
        });
    </script>
</body>
